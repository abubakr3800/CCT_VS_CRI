<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lighting Quality Simulator</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      padding: 2rem;
      background-color: #121212;
      color: #f1f1f1;
    }
    .card {
      transition: all 0.4s ease-in-out;
    }
    .classroom-img {
      max-width: 200px;
      width: 100%;
      transition: opacity 0.8s ease, filter 0.5s;
    }
    .blurred {
      filter: blur(5px);
      opacity: 0.4;
    }
    .hidden {
      display: none !important;
    }
    .feedback-card p {
      margin-bottom: 0.5rem;
    }
    .feedback-card b {
      display: block;
      margin-top: 0.5rem;
      color: #ffc107;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1 class="mb-4">Lighting Quality Simulator</h1>

    <!-- Controls -->
    <div class="card p-4 mb-4">
      <div class="row g-4">

        <div class="col-6">
          <div class="col-md-6">
            <label for="cri" class="form-label">CRI (Color Rendering Index): <span id="criVal">80</span></label>
            <input type="range" class="form-range" id="cri" min="0" max="100" value="80">
          </div>
          <div class="col-md-6">
            <label for="cct" class="form-label">CCT (Color Temperature): <span id="cctVal">4000</span>K</label>
            <input type="range" class="form-range" id="cct" min="1000" max="10000" step="100" value="4000">
          </div>
          <div class="col-md-6">
            <label for="flicker" class="form-label">Flicker (% Modulation): <span id="flickerVal">0</span>%</label>
            <input type="range" class="form-range" id="flicker" min="0" max="100" value="0">
          </div>
          <div class="col-md-6">
            <label for="glare" class="form-label">Glare Level: <span id="glareVal">0</span></label>
            <input type="range" class="form-range" id="glare" min="0" max="100" value="0">
          </div>
        </div>

        <div class="col-6">
          <!-- Classroom Scene Images -->
          <div class="text-center my-4 d-flex justify-content-center gap-3 flex-wrap" id="classroomScene">
            <img src="images/kindergarten.jpg" id="kindergarten" class="classroom-img" alt="Kindergarten">
            <img src="images/primary.jpg" id="primary" class="classroom-img" alt="Primary">
            <img src="images/secondary.jpg" id="secondary" class="classroom-img" alt="Secondary">
            <img src="images/college.jpg" id="college" class="classroom-img" alt="college">
            <img src="images/tunable/s.png" id="sad1" class="classroom-img hidden" alt="Sad 1">
            <img src="images/tunable/t.png" id="sad2" class="classroom-img hidden" alt="Sad 2">
          </div>

          <!-- Warning Text -->
          <div class="text-center mt-4">
            <div id="warningText" class="text-danger fw-bold" style="display:none; font-size: 1.2rem;">
              ⚠️ Lighting conditions are unsuitable for learning. Please adjust Glare or Flicker levels.
            </div>
          </div>

        </div>
      </div>
    </div>

    <!-- Feedback Cards -->
    <div class="row g-4 mt-4" id="cardsContainer">
      <div class="col-md-6">
        <div class="card bg-dark text-light p-3 feedback-card">
          <h5>CRI Feedback</h5>
          <p id="criFeedbackVal">Value: 80</p>
          <p id="criEffect">Effect: Improves color accuracy and reduces eye strain.</p>
          <p id="criCause">Cause: Higher CRI means better spectral match to sunlight.</p>
          <p id="criScenario">Scenario: Students can distinguish colors in art or biology experiments clearly.</p>
          <b id="criScope">Scope: All students; especially important for art and science subjects.</b>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card bg-dark text-light p-3 feedback-card">
          <h5>CCT Feedback</h5>
          <p id="cctFeedbackVal">Value: 4000K</p>
          <p id="cctEffect">Effect: Balances alertness and comfort for focused tasks.</p>
          <p id="cctCause">Cause: Mid-CCT provides a neutral-white tone aiding circadian rhythm balance.</p>
          <p id="cctScenario">Scenario: Students remain alert and comfortable during full-day classes.</p>
          <b id="cctScope">Scope: Ideal for primary to secondary students; enhances reading, math, and discussion.</b>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card bg-dark text-light p-3 feedback-card">
          <h5>Flicker Feedback</h5>
          <p id="flickerFeedbackVal">Value: 0%</p>
          <p id="flickerEffect">Effect: No visible flicker ensures visual comfort and reduces fatigue.</p>
          <p id="flickerCause">Cause: Stable current supply without high-frequency modulation.</p>
          <p id="flickerScenario">Scenario: Students maintain focus longer without headaches.</p>
          <b id="flickerScope">Scope: All students; especially neurodiverse and sensitive individuals.</b>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card bg-dark text-light p-3 feedback-card">
          <h5>Glare Feedback</h5>
          <p id="glareFeedbackVal">Value: 0</p>
          <p id="glareEffect">Effect: No discomfort or visibility issues.</p>
          <p id="glareCause">Cause: Light sources are diffused and properly shielded.</p>
          <p id="glareScenario">Scenario: Students can look at boards or screens without squinting or stress.</p>
          <b id="glareScope">Scope: Essential for all age groups; especially critical in rooms with screens or whiteboards.</b>
        </div>
      </div>
    </div>
  </div>

  <!-- JavaScript -->
  <script>
    const classroomImages = {
      kindergarten: document.getElementById('kindergarten'),
      primary: document.getElementById('primary'),
      secondary: document.getElementById('secondary'),
      college: document.getElementById('college'),
      sad1: document.getElementById('sad1'),
      sad2: document.getElementById('sad2')
    };

    const criSlider = document.getElementById('cri');
    const cctSlider = document.getElementById('cct');
    const flickerSlider = document.getElementById('flicker');
    const glareSlider = document.getElementById('glare');
    const criVal = document.getElementById('criVal');
    const cctVal = document.getElementById('cctVal');
    const flickerVal = document.getElementById('flickerVal');
    const glareVal = document.getElementById('glareVal');

    function updateClassroomImages(cct, flicker, glare) {
      const warningText = document.getElementById('warningText');
      const blurAll = flicker > 30 || glare > 60;

      Object.values(classroomImages).forEach(img => {
        img.classList.add('hidden');
        img.classList.remove('blurred');
      });

      if (blurAll) {
        warningText.style.display = 'block';
        if (glare > 33 && glare <= 66) classroomImages.sad1.classList.remove('hidden');
        else if (glare > 66) classroomImages.sad2.classList.remove('hidden');
        return;
      }

      warningText.style.display = 'none';

      let selected = '';
      if (cct >= 2700 && cct < 3500) selected = 'kindergarten';
      else if (cct >= 3500 && cct < 5000) selected = 'primary';
      else if (cct >= 5000 && cct <= 7000) selected = 'secondary';
      else if (cct > 7000) selected = 'college';

      Object.entries(classroomImages).forEach(([key, img]) => {
        if (['kindergarten', 'primary', 'secondary', 'college'].includes(key)) {
          img.classList.remove('hidden');
          img.classList.toggle('blurred', key !== selected);
        }
      });
    }

    function applyFilters() {
      const cri = parseInt(criSlider.value);
      const cct = parseInt(cctSlider.value);
      const flicker = parseInt(flickerSlider.value);
      const glare = parseInt(glareSlider.value);

      criVal.textContent = cri;
      cctVal.textContent = cct;
      flickerVal.textContent = flicker;
      glareVal.textContent = glare;

      updateClassroomImages(cct, flicker, glare);
    }

    [criSlider, cctSlider, flickerSlider, glareSlider].forEach(input => {
      input.addEventListener('input', applyFilters);
    });

    applyFilters();
  </script>
</body>
</html>
